FROM debian:oldstable

# Domain arguments
ARG DOMAIN_NAME_ARG
# Wordpress arguments
ARG WORDPRESS_HOST_ARG
ARG WORDPRESS_PORT_ARG
ARG WORDPRESS_URL_ARG
ARG WORDPRESS_TITLE_ARG
ARG WORDPRESS_ADMIN_ARG
ARG WORDPRESS_ADMIN_PW_ARG
ARG WORDPRESS_ADMIN_EMAIL_ARG
ARG WORDPRESS_PLUGINS_ARG
# Adminer arguments
ARG ADMINER_FILE_NAME_ARG
# Database arguments
ARG MYSQL_DATABASE_ARG
ARG MYSQL_USER_ARG
ARG MYSQL_USER_PW_ARG
ARG MYSQL_HOST_ARG
# Redis arguments
ARG REDIS_HOST_ARG
ARG REDIS_PORT_ARG
ARG REDIS_PW_ARG

# Domain environment variables
ENV DOMAIN_NAME=$DOMAIN_NAME_ARG
# Wordpress environment variables
ENV WORDPRESS_HOST=$WORDPRESS_HOST_ARG
ENV WORDPRESS_PORT=$WORDPRESS_PORT_ARG
ENV WORDPRESS_URL=$WORDPRESS_URL_ARG
ENV WORDPRESS_TITLE=$WORDPRESS_TITLE_ARG
ENV WORDPRESS_ADMIN=$WORDPRESS_ADMIN_ARG
ENV WORDPRESS_ADMIN_PW=$WORDPRESS_ADMIN_PW_ARG
ENV WORDPRESS_ADMIN_EMAIL=$WORDPRESS_ADMIN_EMAIL_ARG
ENV WORDPRESS_PLUGINS=$WORDPRESS_PLUGINS_ARG
# Adminer environment variables
ENV ADMINER_FILE_NAME=$ADMINER_FILE_NAME_ARG
# Database environment variables
ENV MYSQL_DATABASE=$MYSQL_DATABASE_ARG
ENV MYSQL_USER=$MYSQL_USER_ARG
ENV MYSQL_USER_PW=$MYSQL_USER_PW_ARG
ENV MYSQL_HOST=$MYSQL_HOST_ARG
# Redis environment variables
ENV REDIS_HOST=$REDIS_HOST_ARG
ENV REDIS_PORT=$REDIS_PORT_ARG
ENV REDIS_PW=$REDIS_PW_ARG

COPY conf/. .
COPY tools/. .

RUN apt-get update && apt-get upgrade -y && sh wordpress.sh

CMD ["sh", "start.sh"]